
const affiliateLinks = {

    // CAMERAS - Sony

    "sony-a6700": "https://amzn.to/3NpavhW",
    "sony-a7c-ii": "https://amzn.to/49XHouC",
    "sony-a7iv": "https://amzn.to/3Zmgs1u",
    "sony-a7-v": "NEED_LINK",          // Sony A7 V (新机型)
    "sony-zv-e10": "https://amzn.to/3NqCxth",
    "sony-zv-e10-ii": "https://amzn.to/49HqAH3",
    "sony-zv-e1": "https://amzn.to/3Le0oMc",
    "sony-fx3": "https://amzn.to/4b0w6Ha",

    // CAMERAS - Fujifilm

    "fuji-x100vi": "https://amzn.to/4pGFIdE",
    "fuji-x-t50": "https://amzn.to/4pJH5se",
    "fuji-x-t5": "https://amzn.to/4qSEPQj",
    "fuji-xt5": "https://amzn.to/4qT3Laf",   // Alternative key
    "fuji-x-s20": "https://amzn.to/3YJrfTj",

    // CAMERAS - Canon

    "canon-r50": "https://amzn.to/3YBJTwt",
    "canon-r100": "https://amzn.to/45FQ6eA",
    "canon-r8": "https://amzn.to/3Lvm06M",
    "canon-r6ii": "https://amzn.to/4sHWE6q",
    "canon-r6-ii": "https://amzn.to/4sHWE6q", // Alternative key
    "canon-r6-iii": "NEED_LINK",       // Canon R6 III (新机型)

    // CAMERAS - Panasonic / Lumix

    "panasonic-s5ii": "https://amzn.to/45FQbyU",
    "panasonic-s5iix": "https://amzn.to/49nmk0t",
    "lumix-g100d": "https://amzn.to/4sHwgtm",


    // CAMERAS - Nikon
    "nikon-z8": "https://amzn.to/4sMa95c",

    // CAMERAS - OM System
    "om-system-om5": "https://amzn.to/49TF1cd",

    // CAMERAS - Action / Vlog / 360
    "dji-pocket-3": "https://amzn.to/3NlCOOg",
    "dji-action-5": "https://amzn.to/4jHiYc3",
    "gopro-13": "https://amzn.to/3Ne6SLE",
    "insta360-x4": "https://amzn.to/4aUs0jM",


    // LENSES - Sony E-Mount
    "sony-35": "https://amzn.to/4qDP3EE",            // Sony 35mm f/1.8
    "sony-35-18": "https://amzn.to/4qDP3EE",         // Sony 35mm f/1.8 (alt key)
    "sony-70-350": "https://amzn.to/45jpD6t",        // Sony 70-350mm f/4.5-6.3

    // LENSES - Canon RF-Mount

    "canon-rf-24-105": "https://amzn.to/4baLpgA",    // Canon RF 24-105mm f/4L
    "rf-24-105": "https://amzn.to/4baLpgA",          // Alternative key
    "canon-rf-50": "https://amzn.to/3NTbneE",        // Canon RF 50mm f/1.8
    "rf-50": "https://amzn.to/3NTbneE",              // Alternative key
    "canon-rf-85": "https://amzn.to/4a9hpQ7",        // Canon RF 85mm f/2
    "rf-85": "https://amzn.to/4a9hpQ7",              // Alternative key
    "canon-rfs-18-150": "https://amzn.to/49vdOg1",   // Canon RF-S 18-150mm
    "rfs-18-150": "https://amzn.to/49vdOg1",         // Alternative key

    // LENSES - Fujifilm X-Mount
    "fuji-xf-33": "https://amzn.to/4pSIEE1",         // Fuji XF 33mm f/1.4 WR
    "xf-33": "https://amzn.to/4pSIEE1",              // Alternative key
    "fuji-xf-16-50": "https://amzn.to/4qC3qJq",      // Fuji XF 16-50mm f/2.8-4.8
    "xf-16-50": "https://amzn.to/4qC3qJq",           // Alternative key
    "fuji-xf56-f12": "https://amzn.to/4pPtlfw",      // Fuji XF 56mm f/1.2
    "xf-56": "https://amzn.to/4pPtlfw",              // Alternative key

    // LENSES - Third Party (Sigma, Tamron)
    "sigma-18-50-fuji": "https://amzn.to/4jQ9xHz",   // Sigma 18-50mm f/2.8 (Fuji)
    "sigma-18-50": "https://amzn.to/4sXigfh",        // Sigma 18-50mm f/2.8 (Sony)
    "sigma-56-14": "https://amzn.to/49QDK4N",        // Sigma 56mm f/1.4
    "sigma-56": "https://amzn.to/49QDK4N",           // Alternative key
    "tamron-17-70": "https://amzn.to/49y4Izb",       // Tamron 17-70mm f/2.8

    // GEAR - SD Cards
    "sandisk-extreme-256": "https://amzn.to/49yP9qQ",     // SanDisk Extreme 256GB
    "sandisk-extreme": "https://amzn.to/49yP9qQ",         // Alternative key
    "sandisk-extreme-pro-256": "https://amzn.to/4sPSPMl", // SanDisk Extreme Pro 256GB
    "sandisk-extreme-pro": "https://amzn.to/4sPSPMl",     // Alternative key
    "sandisk-pro": "https://amzn.to/4sPSPMl",             // Alternative key
    "sony-tough-v90": "https://amzn.to/4r2T84M",          // Sony TOUGH V90
    "sony-tough": "https://amzn.to/4r2T84M",              // Alternative key

    // GEAR - Camera Bags
    "peak-everyday-30": "https://amzn.to/4b5V9IV",        // Peak Design Everyday 30L
    "peak-everyday": "https://amzn.to/4b5V9IV",           // Alternative key
    "lowepro-protactic": "https://amzn.to/3LsLstI",       // Lowepro ProTactic
    "lowepro": "https://amzn.to/3LsLstI",                 // Alternative key
    "wandrd-prvke": "https://amzn.to/4pZZFfW",            // WANDRD PRVKE

    // GEAR - Tripods
    "peak-travel-tripod": "https://amzn.to/4qw0vBR",      // Peak Design Travel Tripod
    "peak-travel": "https://amzn.to/4qw0vBR",             // Alternative key
    "manfrotto-befree": "https://amzn.to/4a26V5Y",        // Manfrotto Befree
    "manfrotto": "https://amzn.to/4a26V5Y",               // Alternative key
    "ulanzi-mt79": "https://amzn.to/3YPknE6",             // Ulanzi MT-79

};

// =============================================================================
// DO NOT MODIFY BELOW THIS LINE
// =============================================================================

function applyAffiliateLinks() {
    const isGerman = document.documentElement.lang === 'de';
    const checkPriceText = isGerman ? 'Preis prüfen' : 'Check Price';

    const updateBtn = (btn, url) => {
        if (btn && url && url !== "NEED_LINK") {
            btn.href = url;
            btn.target = "_blank";
            btn.rel = "sponsored noopener noreferrer";
        }
    };

    for (const [id, link] of Object.entries(affiliateLinks)) {
        if (!link || link === "#" || link === "" || link === "NEED_LINK") continue;

        // Strategy A: Wrapper ID
        const section = document.getElementById(id);
        if (section) {
            const btn = section.querySelector('.btn-buy');
            updateBtn(btn, link);
        }

        // Strategy B: Data attribute
        document.querySelectorAll(`.btn-buy[data-product="${id}"]`).forEach(btn => updateBtn(btn, link));

        // Strategy C: Comparison tables
        document.querySelectorAll(`a[href="#${id}"]`).forEach(anchor => {
            const row = anchor.closest('tr');
            if (row) {
                const priceCell = row.querySelector('.price-check');
                if (priceCell) {
                    priceCell.innerHTML = `<a href="${link}" target="_blank" rel="sponsored noopener noreferrer" style="color:#10b981;text-decoration:none;font-weight:800;display:inline-flex;align-items:center;gap:4px">${checkPriceText} <span style="font-size:1.2em">&rarr;</span></a>`;
                }
            }
        });
    }
}

if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", applyAffiliateLinks);
} else {
    applyAffiliateLinks();
}
